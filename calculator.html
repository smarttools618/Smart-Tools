<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Calculator - All-in-One Tool</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #5a75f5;
            --secondary: #3f37c9;
            --accent: #4895ef;
            --light: #f8f9fa;
            --dark: #121826;
            --darker: #0a0f1a;
            --gray: #718096;
            --light-gray: #e2e8f0;
            --success: #48bb78;
            --warning: #ecc94b;
            --danger: #e53e3e;
            --card-bg: #ffffff;
            --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --body-bg: #f0f4f8;
            --text-color: #1a202c;
            --input-bg: #ffffff;
            --border-color: #cbd5e0;
            --result-bg: #f0f7ff;
            --transition: all 0.3s ease;
            --footer-bg: #f0f4f8;
            --footer-color: #718096;
        }

        .dark-mode {
            --primary: #5a75f5;
            --primary-light: #6d86ff;
            --secondary: #4d46c1;
            --accent: #5ca5f5;
            --light: #2d3748;
            --dark: #e2e8f0;
            --darker: #f8f9fa;
            --gray: #a0aec0;
            --light-gray: #4a5568;
            --card-bg: #1a202c;
            --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            --body-bg: #121826;
            --text-color: #e2e8f0;
            --input-bg: #2d3748;
            --border-color: #4a5568;
            --result-bg: #1e293b;
            --footer-bg: #0a0f1a;
            --footer-color: #a0aec0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            background: var(--body-bg);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            max-width: 1200px;
            width: 100%;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 20px;
            width: 100%;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--card-shadow);
        }

        .logo-icon i {
            font-size: 24px;
            color: white;
        }

        .logo h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-color);
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .mode-toggle {
            width: 60px;
            height: 30px;
            background: var(--light-gray);
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            border: none;
            outline: none;
        }

        .mode-toggle:after {
            content: '';
            position: absolute;
            width: 26px;
            height: 26px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: var(--transition);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .dark-mode .mode-toggle:after {
            left: 32px;
            background: var(--darker);
        }

        .mode-toggle i {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 14px;
            color: var(--text-color);
        }

        .mode-toggle .sun {
            left: 7px;
        }

        .mode-toggle .moon {
            right: 7px;
        }

        .home-btn, .lang-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--card-bg);
            border: none;
            border-radius: 50px;
            color: var(--text-color);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--card-shadow);
            text-decoration: none;
        }

        .home-btn:hover, .lang-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-3px);
        }

        .lang-buttons {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .lang-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 20px;
            background: var(--card-bg);
            color: var(--text-color);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--card-shadow);
            font-size: 14px;
        }

        .lang-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .lang-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Calculator Tabs */
        .tabs {
            display: flex;
            background: var(--card-bg);
            border-radius: 50px;
            padding: 5px;
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
            flex-wrap: wrap;
        }

        .tab-btn {
            flex: 1;
            padding: 15px;
            border: none;
            background: transparent;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: var(--text-color);
            min-width: 120px;
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
        }

        .tab-btn:hover:not(.active) {
            background: var(--light-gray);
        }

        /* Calculator Content */
        .calculator-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 40px;
        }

        @media (max-width: 900px) {
            .calculator-content {
                grid-template-columns: 1fr;
            }
        }

        .calculator-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            display: none; /* Hide all by default */
        }

        .calculator-card.active {
            display: block; /* Show active calculator */
        }

        .calculator-header {
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .calculator-header h2 {
            font-size: 24px;
            color: var(--text-color);
        }

        .calculator-header i {
            font-size: 24px;
            color: var(--primary);
        }

        /* Standard Calculator */
        .calc-display {
            background: var(--light-gray);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: right;
            font-size: 32px;
            font-weight: 600;
            min-height: 80px;
            overflow: hidden;
            color: var(--text-color);
        }

        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        .calc-btn {
            padding: 16px;
            border: none;
            border-radius: 12px;
            background: var(--light-gray);
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-color);
        }

        .calc-btn:hover {
            background: var(--border-color);
        }

        .calc-btn.operator {
            background: var(--primary);
            color: white;
        }

        .calc-btn.operator:hover {
            background: var(--primary-light);
        }

        .calc-btn.equal {
            background: var(--success);
            color: white;
            grid-column: span 2;
        }

        .calc-btn.equal:hover {
            background: #38a169;
        }

        /* Other Calculators */
        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 14px;
            background: var(--input-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            font-size: 16px;
            transition: var(--transition);
            color: var(--text-color);
        }

        .input-group input:focus, .input-group select:focus {
            border-color: var(--primary);
            outline: none;
        }

        .calculate-btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            background: var(--primary);
            color: white;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px;
        }

        .calculate-btn:hover {
            background: var(--primary-light);
            transform: translateY(-3px);
        }

        .result-container {
            margin-top: 25px;
            padding: 20px;
            background: var(--result-bg);
            border-radius: 12px;
            text-align: center;
        }

        .result-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }

        .result-label {
            font-size: 16px;
            color: var(--gray);
        }

        /* Graph Container */
        .graph-container {
            height: 250px;
            margin-top: 20px;
            background: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: auto;
            width: 100%;
            color: var(--footer-color);
            background: var(--footer-bg);
            border-radius: 15px;
        }

        .contact-email {
            font-size: 18px;
            margin-top: 10px;
        }

        .contact-email a {
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
            font-weight: 600;
        }

        .contact-email a:hover {
            text-decoration: underline;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 15px;
            }
            
            .logo {
                justify-content: center;
            }
            
            .header-controls {
                width: 100%;
                justify-content: center;
            }
            
            .tabs {
                overflow-x: auto;
                padding: 5px 0;
                justify-content: center;
            }
            
            .tab-btn {
                font-size: 14px;
                padding: 10px 15px;
                min-width: auto;
                flex: none;
            }
            
            .calculator-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .logo h1 {
                font-size: 24px;
            }
            
            .home-btn, .lang-btn {
                padding: 8px 15px;
                font-size: 14px;
            }
            
            .calculator-card {
                padding: 20px;
            }
            
            .calc-display {
                font-size: 28px;
                min-height: 70px;
            }
            
            .calc-btn {
                padding: 12px;
                font-size: 18px;
            }
        }

        /* Keyboard instructions */
        .keyboard-instructions {
            margin-top: 15px;
            font-size: 14px;
            color: var(--gray);
            text-align: center;
            padding: 8px;
            background: var(--light-gray);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-calculator"></i>
                </div>
                <h1 id="appTitle">Smart Calculator</h1>
            </div>
            <div class="header-controls">
                <a href="https://smrttoolz.blogspot.com/" class="home-btn" target="_self" id="homeBtn">
                    <i class="fas fa-home"></i> <span id="homeText">Home</span>
                </a>
                
                <button class="mode-toggle" id="modeToggle">
                    <i class="fas fa-sun sun"></i>
                    <i class="fas fa-moon moon"></i>
                </button>
                
                <div class="lang-buttons">
                    <button class="lang-btn" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="fr">FR</button>
                    <button class="lang-btn" data-lang="ar">ع</button>
                </div>
            </div>
        </header>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="standard">
                <i class="fas fa-calculator"></i> <span id="standardTab">Standard</span>
            </button>
            <button class="tab-btn" data-tab="area">
                <i class="fas fa-shapes"></i> <span id="areaTab">Area</span>
            </button>
            <button class="tab-btn" data-tab="date">
                <i class="fas fa-calendar-alt"></i> <span id="dateTab">Date</span>
            </button>
            <button class="tab-btn" data-tab="bmi">
                <i class="fas fa-weight-scale"></i> <span id="bmiTab">BMI</span>
            </button>
            <button class="tab-btn" data-tab="percentage">
                <i class="fas fa-percent"></i> <span id="percentageTab">Percentage</span>
            </button>
        </div>

        <!-- Calculator Content -->
        <div class="calculator-content">
            <!-- Standard Calculator -->
            <div class="calculator-card active" id="standard-calc">
                <div class="calculator-header">
                    <h2 id="standardTitle">Standard Calculator</h2>
                    <i class="fas fa-calculator"></i>
                </div>
                <div class="calc-display" id="display">0</div>
                <div class="calc-buttons">
                    <button class="calc-btn" data-value="C">C</button>
                    <button class="calc-btn" data-value="DEL">DEL</button>
                    <button class="calc-btn operator" data-value="/">/</button>
                    <button class="calc-btn operator" data-value="*">×</button>
                    
                    <button class="calc-btn" data-value="7">7</button>
                    <button class="calc-btn" data-value="8">8</button>
                    <button class="calc-btn" data-value="9">9</button>
                    <button class="calc-btn operator" data-value="-">-</button>
                    
                    <button class="calc-btn" data-value="4">4</button>
                    <button class="calc-btn" data-value="5">5</button>
                    <button class="calc-btn" data-value="6">6</button>
                    <button class="calc-btn operator" data-value="+">+</button>
                    
                    <button class="calc-btn" data-value="1">1</button>
                    <button class="calc-btn" data-value="2">2</button>
                    <button class="calc-btn" data-value="3">3</button>
                    <button class="calc-btn" data-value=".">.</button>
                    
                    <button class="calc-btn" data-value="0">0</button>
                    <button class="calc-btn" data-value="00">00</button>
                    <button class="calc-btn equal" data-value="=">=</button>
                </div>
                <div class="keyboard-instructions">
                    <i class="fas fa-keyboard"></i> Use keyboard: Numbers, +, -, *, /, Enter, Backspace, Escape
                </div>
            </div>

            <!-- Area Calculator -->
            <div class="calculator-card" id="area-calc">
                <div class="calculator-header">
                    <h2 id="areaTitle">Area Calculator</h2>
                    <i class="fas fa-shapes"></i>
                </div>
                <div class="input-group">
                    <label for="shape" id="shapeLabel">Select Shape</label>
                    <select id="shape">
                        <option value="rectangle" id="rectOption">Rectangle</option>
                        <option value="circle" id="circleOption">Circle</option>
                        <option value="triangle" id="triOption">Triangle</option>
                        <option value="square" id="squareOption">Square</option>
                    </select>
                </div>
                
                <div id="rectangle-inputs">
                    <div class="input-group">
                        <label for="length" id="lengthLabel">Length</label>
                        <input type="number" id="length" placeholder="Enter length">
                    </div>
                    <div class="input-group">
                        <label for="width" id="widthLabel">Width</label>
                        <input type="number" id="width" placeholder="Enter width">
                    </div>
                </div>
                
                <div id="circle-inputs" style="display: none;">
                    <div class="input-group">
                        <label for="radius" id="radiusLabel">Radius</label>
                        <input type="number" id="radius" placeholder="Enter radius">
                    </div>
                </div>
                
                <div id="triangle-inputs" style="display: none;">
                    <div class="input-group">
                        <label for="base" id="baseLabel">Base</label>
                        <input type="number" id="base" placeholder="Enter base">
                    </div>
                    <div class="input-group">
                        <label for="height" id="heightLabel">Height</label>
                        <input type="number" id="height" placeholder="Enter height">
                    </div>
                </div>
                
                <div id="square-inputs" style="display: none;">
                    <div class="input-group">
                        <label for="side" id="sideLabel">Side</label>
                        <input type="number" id="side" placeholder="Enter side length">
                    </div>
                </div>
                
                <div class="result-container">
                    <div class="result-label" id="areaResultLabel">Area</div>
                    <div class="result-value" id="area-result">0</div>
                    <div class="result-label" id="areaUnitLabel">square units</div>
                </div>
            </div>

            <!-- Date Calculator -->
            <div class="calculator-card" id="date-calc">
                <div class="calculator-header">
                    <h2 id="dateTitle">Date Calculator</h2>
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div class="input-group">
                    <label for="date1" id="date1Label">First Date</label>
                    <input type="date" id="date1">
                </div>
                
                <div class="input-group">
                    <label for="date2" id="date2Label">Second Date</label>
                    <input type="date" id="date2">
                </div>
                
                <div class="result-container">
                    <div class="result-label" id="diffLabel">Difference</div>
                    <div class="result-value" id="date-result">0 days</div>
                </div>
            </div>

            <!-- BMI Calculator -->
            <div class="calculator-card" id="bmi-calc">
                <div class="calculator-header">
                    <h2 id="bmiTitle">BMI Calculator</h2>
                    <i class="fas fa-weight-scale"></i>
                </div>
                <div class="input-group">
                    <label for="bmi-height" id="bmiHeightLabel">Height (cm)</label>
                    <input type="number" id="bmi-height" placeholder="Enter height in cm">
                </div>
                
                <div class="input-group">
                    <label for="bmi-weight" id="bmiWeightLabel">Weight (kg)</label>
                    <input type="number" id="bmi-weight" placeholder="Enter weight in kg">
                </div>
                
                <div class="result-container">
                    <div class="result-label" id="bmiResultLabel">Your BMI</div>
                    <div class="result-value" id="bmi-result">0</div>
                    <div class="result-label" id="bmi-category">-</div>
                </div>
                
                <div style="margin-top: 20px; text-align: center;">
                    <h3 id="bmiCatTitle">BMI Categories</h3>
                    <p id="underweight">Underweight: < 18.5</p>
                    <p id="normal">Normal weight: 18.5 - 24.9</p>
                    <p id="overweight">Overweight: 25 - 29.9</p>
                    <p id="obesity">Obesity: ≥ 30</p>
                </div>
            </div>

            <!-- Percentage Calculator -->
            <div class="calculator-card" id="percentage-calc">
                <div class="calculator-header">
                    <h2 id="percentageTitle">Percentage Calculator</h2>
                    <i class="fas fa-percent"></i>
                </div>
                <div class="input-group">
                    <label for="base-value" id="baseLabel">Base Value</label>
                    <input type="number" id="base-value" placeholder="Enter base value">
                </div>
                
                <div class="input-group">
                    <label for="percentage" id="percentLabel">Percentage</label>
                    <input type="number" id="percentage" placeholder="Enter percentage">
                </div>
                
                <div class="result-container">
                    <div class="result-label" id="percentResultLabel">Result</div>
                    <div class="result-value" id="percentage-result">0</div>
                </div>
                
                <div class="graph-container" id="graph-container">
                    <canvas id="percentage-chart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="contact-email">
            <span id="contactText">Contact us:</span> 
            <a href="mailto:smarttools618@gmail.com">smarttools618@gmail.com</a>
        </div>
    </footer>

    <script>
        // Language support
        const languages = {
            en: {
                title: "Smart Calculator",
                home: "Home",
                lang: "English",
                standardTab: "Standard",
                areaTab: "Area",
                dateTab: "Date",
                bmiTab: "BMI",
                percentageTab: "Percentage",
                standardTitle: "Standard Calculator",
                areaTitle: "Area Calculator",
                dateTitle: "Date Calculator",
                bmiTitle: "BMI Calculator",
                percentageTitle: "Percentage Calculator",
                shapeLabel: "Select Shape",
                rectOption: "Rectangle",
                circleOption: "Circle",
                triOption: "Triangle",
                squareOption: "Square",
                lengthLabel: "Length",
                widthLabel: "Width",
                radiusLabel: "Radius",
                baseLabel: "Base", // Note: 'baseLabel' is used for Triangle and Percentage, ensure context is clear.
                heightLabel: "Height",
                sideLabel: "Side",
                areaResultLabel: "Area",
                areaUnitLabel: "square units",
                date1Label: "First Date",
                date2Label: "Second Date",
                diffLabel: "Difference",
                // startDateLabel: "Start Date", // Corresponds to undefined elements
                // daysLabel: "Days to Add/Subtract", // Corresponds to undefined elements
                // newDateLabel: "Result Date", // Corresponds to undefined elements
                bmiHeightLabel: "Height (cm)",
                bmiWeightLabel: "Weight (kg)",
                bmiResultLabel: "Your BMI",
                bmiCatTitle: "BMI Categories",
                underweight: "Underweight: < 18.5",
                normal: "Normal weight: 18.5 - 24.9",
                overweight: "Overweight: 25 - 29.9",
                obesity: "Obesity: ≥ 30",
                baseValue: "Base Value", // For percentage calculator
                // baseLabel: "Base Value", // Already covered by the more general 'baseLabel' from triangle
                percentLabel: "Percentage",
                percentResultLabel: "Result",
                baseInputPlaceholder: "Enter base value",
                percentInputPlaceholder: "Enter percentage",
                graphBtn: "Show Graph",
                contactText: "Contact us:",
                yearSingular: "year",
                yearPlural: "years",
                monthSingular: "month",
                monthPlural: "months",
                daySingular: "day",
                dayPlural: "days",
                invalidDateMessage: "Invalid dates",
            },
            fr: {
                title: "Calculatrice Intelligente",
                home: "Accueil",
                lang: "Français",
                standardTab: "Standard",
                areaTab: "Surface",
                dateTab: "Date",
                bmiTab: "IMC",
                percentageTab: "Pourcentage",
                standardTitle: "Calculatrice Standard",
                areaTitle: "Calculateur de Surface",
                dateTitle: "Calculateur de Date",
                bmiTitle: "Calculateur d'IMC",
                percentageTitle: "Calculateur de Pourcentage",
                shapeLabel: "Sélectionner une forme",
                rectOption: "Rectangle",
                circleOption: "Cercle",
                triOption: "Triangle",
                squareOption: "Carré",
                lengthLabel: "Longueur",
                widthLabel: "Largeur",
                radiusLabel: "Rayon",
                baseLabel: "Base",
                heightLabel: "Hauteur",
                sideLabel: "Côté",
                areaResultLabel: "Surface",
                areaUnitLabel: "unités carrées",
                date1Label: "Première date",
                date2Label: "Deuxième date",
                diffLabel: "Différence",
                // startDateLabel: "Date de début",
                // daysLabel: "Jours à ajouter/soustraire",
                // newDateLabel: "Date résultante",
                bmiHeightLabel: "Taille (cm)",
                bmiWeightLabel: "Poids (kg)",
                bmiResultLabel: "Votre IMC",
                bmiCatTitle: "Catégories d'IMC",
                underweight: "Insuffisance pondérale: < 18.5",
                normal: "Poids normal: 18.5 - 24.9",
                overweight: "Surpoids: 25 - 29.9",
                obesity: "Obésité: ≥ 30",
                baseValue: "Valeur de base",
                percentLabel: "Pourcentage",
                percentResultLabel: "Résultat",
                baseInputPlaceholder: "Entrez la valeur de base",
                percentInputPlaceholder: "Entrez le pourcentage",
                graphBtn: "Afficher le graphique",
                contactText: "Contactez-nous:",
                yearSingular: "an",
                yearPlural: "ans",
                monthSingular: "mois",
                monthPlural: "mois",
                daySingular: "jour",
                dayPlural: "jours",
                invalidDateMessage: "Dates invalides",
            },
            ar: {
                title: "آلة حاسبة ذكية",
                home: "الصفحة الرئيسية",
                lang: "العربية",
                standardTab: "قياسي",
                areaTab: "المساحة",
                dateTab: "تاريخ",
                bmiTab: "مؤشر كتلة الجسم",
                percentageTab: "النسبة المئوية",
                standardTitle: "آلة حاسبة قياسية",
                areaTitle: "آلة حاسبة المساحة",
                dateTitle: "آلة حاسبة التاريخ",
                bmiTitle: "آلة حاسبة مؤشر كتلة الجسم",
                percentageTitle: "آلة حاسبة النسبة المئوية",
                shapeLabel: "اختر الشكل",
                rectOption: "مستطيل",
                circleOption: "دائرة",
                triOption: "مثلث",
                squareOption: "مربع",
                lengthLabel: "الطول",
                widthLabel: "العرض",
                radiusLabel: "نصف القطر",
                baseLabel: "القاعدة",
                heightLabel: "الارتفاع",
                sideLabel: "الجانب",
                areaResultLabel: "منطقة",
                areaUnitLabel: "وحدات مربعة",
                date1Label: "التاريخ الأول",
                date2Label: "التاريخ الثاني",
                diffLabel: "الفرق",
                // startDateLabel: "تاريخ البدء",
                // daysLabel: "أيام للإضافة / الطرح",
                // newDateLabel: "تاريخ النتيجة",
                bmiHeightLabel: "الطول (سم)",
                bmiWeightLabel: "الوزن (كجم)",
                bmiResultLabel: "مؤشر كتلة جسمك",
                bmiCatTitle: "فئات مؤشر كتلة الجسم",
                underweight: "نقص الوزن: < 18.5",
                normal: "وزن طبيعي: 18.5 - 24.9",
                overweight: "زيادة الوزن: 25 - 29.9",
                obesity: "السمنة: ≥ 30",
                baseValue: "القيمة الأساسية",
                percentLabel: "النسبة المئوية",
                percentResultLabel: "النتيجة",
                baseInputPlaceholder: "أدخل القيمة الأساسية",
                percentInputPlaceholder: "أدخل النسبة المئوية",
                graphBtn: "عرض الرسم البياني",
                contactText: "اتصل بنا:",
                yearSingular: "سنة",
                yearPlural: "سنوات",
                monthSingular: "شهر",
                monthPlural: "أشهر",
                daySingular: "يوم",
                dayPlural: "أيام",
                invalidDateMessage: "تواريخ غير صالحة",
            }
        };

        // Language button functionality
        const langButtons = document.querySelectorAll('.lang-btn');
        let currentLang = 'en';  // Set English as default language always
        
        // Dark mode state
        let darkMode = false; // Declare and initialize darkMode

        // Percentage Chart instance
        let percentageChart; // Declare globally

        langButtons.forEach(button => {
            // Set initial active state
            button.classList.toggle('active', button.dataset.lang === currentLang);
            
            // Add click handler
            button.addEventListener('click', () => {
                const newLang = button.dataset.lang;
                updateLanguage(newLang);
            });
        });

        function updateLanguage(lang) {
            currentLang = lang;
            const langData = languages[lang];
            
            // Update active state of language buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });
            // Update UI elements
            document.getElementById('appTitle').textContent = langData.title;
            document.getElementById('homeText').textContent = langData.home;
            
            // Update Base Value labels in percentage calculator. ID for this label in HTML is 'baseLabel'
            // document.getElementById('baseValueLabel').textContent = langData.baseValue; // Assuming 'baseValueLabel' is the ID

            // For percentage calculator, the label for "Base Value" has id="baseLabel"
            // which conflicts with the one for triangle. We need to be specific.
            const percentageBaseLabel = document.querySelector('#percentage-calc label[for="base-value"]');
            if (percentageBaseLabel) {
                percentageBaseLabel.textContent = langData.baseValue || langData.baseLabel; // Fallback to generic baseLabel if baseValue not specific
            }

            // Update tab names
            document.getElementById('standardTab').textContent = langData.standardTab;
            document.getElementById('areaTab').textContent = langData.areaTab;
            document.getElementById('dateTab').textContent = langData.dateTab;
            document.getElementById('bmiTab').textContent = langData.bmiTab;
            document.getElementById('percentageTab').textContent = langData.percentageTab;
            
            // Update calculator titles
            document.getElementById('standardTitle').textContent = langData.standardTitle;
            document.getElementById('areaTitle').textContent = langData.areaTitle;
            document.getElementById('dateTitle').textContent = langData.dateTitle;
            document.getElementById('bmiTitle').textContent = langData.bmiTitle;
            document.getElementById('percentageTitle').textContent = langData.percentageTitle;
            
            // Area calculator
            document.getElementById('shapeLabel').textContent = langData.shapeLabel;
            document.getElementById('rectOption').textContent = langData.rectOption;
            document.getElementById('circleOption').textContent = langData.circleOption;
            document.getElementById('triOption').textContent = langData.triOption;
            document.getElementById('squareOption').textContent = langData.squareOption;
            document.getElementById('lengthLabel').textContent = langData.lengthLabel;
            document.getElementById('widthLabel').textContent = langData.widthLabel;
            document.getElementById('radiusLabel').textContent = langData.radiusLabel;
            // For triangle calculator, the label for "Base" has id="baseLabel"
            const triangleBaseLabel = document.querySelector('#triangle-inputs label[for="base"]');
            if (triangleBaseLabel) {
                triangleBaseLabel.textContent = langData.baseLabel;
            }
            document.getElementById('heightLabel').textContent = langData.heightLabel;
            document.getElementById('sideLabel').textContent = langData.sideLabel;
            document.getElementById('areaResultLabel').textContent = langData.areaResultLabel;
            document.getElementById('areaUnitLabel').textContent = langData.areaUnitLabel;
            
            // Date calculator
            document.getElementById('date1Label').textContent = langData.date1Label;
            document.getElementById('date2Label').textContent = langData.date2Label;
            document.getElementById('diffLabel').textContent = langData.diffLabel;
            
            // BMI calculator
            document.getElementById('bmiHeightLabel').textContent = langData.bmiHeightLabel;
            document.getElementById('bmiWeightLabel').textContent = langData.bmiWeightLabel;
            document.getElementById('bmiResultLabel').textContent = langData.bmiResultLabel;
            document.getElementById('bmiCatTitle').textContent = langData.bmiCatTitle;
            document.getElementById('underweight').textContent = langData.underweight;
            document.getElementById('normal').textContent = langData.normal;
            document.getElementById('overweight').textContent = langData.overweight;
            document.getElementById('obesity').textContent = langData.obesity;
            
            // Percentage calculator (label for percentage input)
            document.getElementById('percentLabel').textContent = langData.percentLabel;
            document.getElementById('percentResultLabel').textContent = langData.percentResultLabel;
            
            // Update placeholders
            document.getElementById('length').placeholder = langData.lengthLabel;
            document.getElementById('width').placeholder = langData.widthLabel;
            document.getElementById('radius').placeholder = langData.radiusLabel;
            document.getElementById('base').placeholder = langData.baseLabel; // Triangle base placeholder
            document.getElementById('height').placeholder = langData.heightLabel;
            document.getElementById('side').placeholder = langData.sideLabel;
            document.getElementById('bmi-height').placeholder = langData.bmiHeightLabel;
            document.getElementById('bmi-weight').placeholder = langData.bmiWeightLabel;
            document.getElementById('base-value').placeholder = langData.baseInputPlaceholder; // Percentage base value placeholder
            document.getElementById('percentage').placeholder = langData.percentInputPlaceholder;
            
            // Update chart if it exists
            if (percentageChart) {
                percentageChart.options.plugins.title.text = langData.graphBtn;
                // Ensure correct labels for chart data
                const chartBaseLabel = langData.baseValue || langData.baseLabel; // Use specific if available
                const chartPercentResultLabel = langData.percentResultLabel; // Or a more fitting label for the result bar
                percentageChart.data.labels = [chartBaseLabel, chartPercentResultLabel]; // Adjusted for clarity
                percentageChart.update();
            }
            
            // Update document direction for Arabic
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            
            // Store selected language
            localStorage.setItem('selectedLang', lang);
            
            // Recalculate date difference to update display in new language
            if (date1Input.value && date2Input.value) {
                calculateDateDifference();
            }
             // Recalculate BMI to update category text
            calculateBMI();
        }

        // Dark mode toggle
        const modeToggle = document.getElementById('modeToggle');
        modeToggle.addEventListener('click', () => {
            darkMode = !darkMode;
            document.body.classList.toggle('dark-mode', darkMode);
            updateChartTheme();
        });

        // Tab switching functionality
        const tabBtns = document.querySelectorAll('.tab-btn');
        const calculatorCards = document.querySelectorAll('.calculator-card');

        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all buttons
                tabBtns.forEach(b => b.classList.remove('active'));
                // Add active class to clicked button
                btn.classList.add('active');
                
                // Hide all calculator cards
                calculatorCards.forEach(card => card.classList.remove('active'));
                
                // Show the selected calculator card
                const tab = btn.getAttribute('data-tab');
                document.getElementById(`${tab}-calc`).classList.add('active');
            });
        });

        // Standard Calculator
        const display = document.getElementById('display');
        const calcBtns = document.querySelectorAll('.calc-btn');
        let currentInput = '0';
        let previousInput = '';
        let operation = null;
        let shouldResetDisplay = false;

        calcBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const value = btn.getAttribute('data-value');
                handleCalculatorInput(value);
            });
        });

        function handleCalculatorInput(value) {
            if (value === 'C') {
                // Clear calculator
                currentInput = '0';
                previousInput = '';
                operation = null;
                updateDisplay();
                return;
            }
            
            if (value === 'DEL') {
                // Delete last character
                currentInput = currentInput.toString().slice(0, -1);
                if (currentInput === '') currentInput = '0';
                updateDisplay();
                return;
            }
            
            if (['+', '-', '*', '/'].includes(value)) {
                // Operation button pressed
                if (previousInput !== '' && currentInput !== '0' && !shouldResetDisplay) { // Avoid calculating if currentInput is just reset placeholder
                    calculate();
                }
                operation = value;
                previousInput = currentInput;
                // currentInput = '0'; // Keep currentInput displayed until new number starts
                shouldResetDisplay = true; 
                return;
            }
            
            if (value === '=') {
                if (previousInput === '' || operation === null) return;
                calculate();
                operation = null;
                previousInput = '';
                shouldResetDisplay = true;
                return;
            }
            
            if (value === '.') {
                if (shouldResetDisplay) { // If starting new number after operator
                    currentInput = '0.';
                    shouldResetDisplay = false;
                } else if (!currentInput.includes('.')) {
                    currentInput += '.';
                }
                updateDisplay();
                return;
            }
            
            // Number button pressed
            if (currentInput === '0' || shouldResetDisplay) {
                currentInput = value;
                shouldResetDisplay = false;
            } else {
                currentInput += value;
            }
            
            updateDisplay();
        }

        function updateDisplay() {
            display.textContent = currentInput;
        }

        function calculate() {
            let result;
            const prev = parseFloat(previousInput);
            const current = parseFloat(currentInput);
            
            if (isNaN(prev) || isNaN(current)) { // Check both operands
                // If current is NaN (e.g. after operator, before new number), use prev as result
                if (operation && !isNaN(prev)) {
                    currentInput = previousInput; 
                }
                return;
            }
            
            switch (operation) {
                case '+':
                    result = prev + current;
                    break;
                case '-':
                    result = prev - current;
                    break;
                case '*':
                    result = prev * current;
                    break;
                case '/':
                    if (current === 0) {
                        currentInput = "Error"; // Handle division by zero
                        previousInput = '';
                        operation = null;
                        shouldResetDisplay = true;
                        updateDisplay();
                        return;
                    }
                    result = prev / current;
                    break;
                default:
                    return;
            }
            
            currentInput = result.toString();
            updateDisplay();
        }
        // Keyboard support for all calculators
        document.addEventListener('keydown', (e) => {
            // Get active calculator section
            const activeCalc = document.querySelector('.calculator-card.active');
            if (!activeCalc) return;
            
            const key = e.key;
            
            // Handle standard calculator keyboard input
            if (activeCalc.id === 'standard-calc') {
                let value = null;
                if (key >= '0' && key <= '9') {
                    value = key;
                } else if (key === '.') {
                    value = '.';
                } else if (key === '+') {
                    value = '+';
                } else if (key === '-') {
                    value = '-';
                } else if (key === '*') {
                    value = '*';
                } else if (key === '/') {
                    value = '/';
                } else if (key === 'Enter' || key === '=') {
                    value = '=';
                } else if (key === 'Escape') {
                    value = 'C';
                } else if (key === 'Backspace') {
                    value = 'DEL';
                } else if (key === ',') { // Allow comma as decimal separator
                    value = '.';
                }
                
                if (value !== null) {
                    handleCalculatorInput(value);
                    e.preventDefault(); // Prevent default action for keys like Enter, Backspace
                }
                return;
            }
            
            // For other calculators, allow default input behavior if an input field is focused
            const focusedElement = document.activeElement;
            if (focusedElement && (focusedElement.tagName === 'INPUT' || focusedElement.tagName === 'SELECT')) {
                // For number inputs, trigger calculation on Enter if needed
                if (key === 'Enter' && focusedElement.type === 'number') {
                    if (activeCalc.id === 'area-calc') calculateArea();
                    else if (activeCalc.id === 'bmi-calc') calculateBMI();
                    else if (activeCalc.id === 'percentage-calc') calculatePercentage();
                    e.preventDefault();
                }
                return; 
            }
        });

        // Area Calculator
        const shapeSelect = document.getElementById('shape');
        const areaResult = document.getElementById('area-result');
        
        // Show/hide inputs based on shape
        shapeSelect.addEventListener('change', () => {
            const shape = shapeSelect.value;
            
            // Hide all inputs
            document.getElementById('rectangle-inputs').style.display = 'none';
            document.getElementById('circle-inputs').style.display = 'none';
            document.getElementById('triangle-inputs').style.display = 'none';
            document.getElementById('square-inputs').style.display = 'none';
            
            // Show selected shape inputs
            document.getElementById(`${shape}-inputs`).style.display = 'block';
            calculateArea();
        });
        
        // Add event listeners to area inputs
        const areaInputs = document.querySelectorAll('#area-calc input');
        areaInputs.forEach(input => {
            input.addEventListener('input', calculateArea);
        });
        
        function calculateArea() {
            const shape = shapeSelect.value;
            let area = 0;
              switch (shape) {
                case 'rectangle':
                    const length = parseFloat(document.getElementById('length').value) || 0;
                    const width = parseFloat(document.getElementById('width').value) || 0;
                    area = length * width;
                    break;
                case 'circle':
                    const radius = parseFloat(document.getElementById('radius').value) || 0;
                    area = Math.PI * radius * radius;
                    break;
                case 'triangle':
                    const base = parseFloat(document.getElementById('base').value) || 0;
                    const height = parseFloat(document.getElementById('height').value) || 0;
                    area = 0.5 * base * height;
                    break;
                case 'square':
                    const side = parseFloat(document.getElementById('side').value) || 0;
                    area = side * side;
                    break;
            }
            
            // Remove .00 if the number is whole
            areaResult.textContent = area % 1 === 0 ? Math.round(area) : area.toFixed(2);
        }

        // Date Calculator
        const date1Input = document.getElementById('date1');
        const date2Input = document.getElementById('date2');
        const dateResult = document.getElementById('date-result');
        
        // Add event listeners to date inputs
        date1Input.addEventListener('change', calculateDateDifference);
        date2Input.addEventListener('change', calculateDateDifference);
        
        function calculateDateDifference() {
            const date1 = new Date(date1Input.value);
            const date2 = new Date(date2Input.value);
            
            if (!date1Input.value || !date2Input.value || isNaN(date1.getTime()) || isNaN(date2.getTime())) {
                dateResult.textContent = languages[currentLang].invalidDateMessage || 'Invalid dates';
                return;
            }
            
            const earlier = date1 < date2 ? date1 : date2;
            const later = date1 < date2 ? date2 : date1;
            
            let years = later.getFullYear() - earlier.getFullYear();
            let months = later.getMonth() - earlier.getMonth();
            let days = later.getDate() - earlier.getDate();

            // Adjust if days difference is negative
            if (days < 0) {
                months--;
                // Get the last day of the previous month relative to 'later' date
                const temp = new Date(later.getFullYear(), later.getMonth(), 0);
                days += temp.getDate();
            }

            // Adjust if months difference is negative
            if (months < 0) {
                years--;
                months += 12;
            }

            // Build the result string
            let resultParts = [];
            if (years > 0) {
                resultParts.push(`${years} ${years === 1 ? 
                    (languages[currentLang].yearSingular || 'year') : 
                    (languages[currentLang].yearPlural || 'years')}`);
            }
            if (months > 0) {
                resultParts.push(`${months} ${months === 1 ? 
                    (languages[currentLang].monthSingular || 'month') : 
                    (languages[currentLang].monthPlural || 'months')}`);
            }
            // Always show days, even if 0, if no years or months are shown.
            if (days >= 0 ) { // Allow 0 days if it's the only unit or part of the diff
                 if (resultParts.length === 0 || days > 0) {
                    resultParts.push(`${days} ${days === 1 ? 
                        (languages[currentLang].daySingular || 'day') : 
                        (languages[currentLang].dayPlural || 'days')}`);
                 }
            }
            
            dateResult.textContent = resultParts.length > 0 ? resultParts.join(', ') : `0 ${(languages[currentLang].dayPlural || 'days')}`;
        }
        
        // BMI Calculator
        const bmiHeightInput = document.getElementById('bmi-height');
        const bmiWeightInput = document.getElementById('bmi-weight');
        const bmiResult = document.getElementById('bmi-result');
        const bmiCategory = document.getElementById('bmi-category');
        
        // Add event listeners to BMI inputs
        bmiHeightInput.addEventListener('input', calculateBMI);
        bmiWeightInput.addEventListener('input', calculateBMI);
        
        function calculateBMI() {
            const height = parseFloat(bmiHeightInput.value) || 0;
            const weight = parseFloat(bmiWeightInput.value) || 0;
            const langData = languages[currentLang];
            
            if (height <= 0 || weight <= 0) {
                bmiResult.textContent = '0';
                bmiCategory.textContent = '-';
                return;
            }
            
            // Convert height to meters
            const heightInMeters = height / 100;
            const bmi = weight / (heightInMeters * heightInMeters);
            
            bmiResult.textContent = bmi.toFixed(1);
            
            // Determine category
            if (bmi < 18.5) {
                bmiCategory.textContent = langData.underweight.split(':')[0]; // Show only category name
                bmiCategory.style.color = 'var(--warning)'; // Use warning for underweight
            } else if (bmi < 25) {
                bmiCategory.textContent = langData.normal.split(':')[0];
                bmiCategory.style.color = 'var(--success)';
            } else if (bmi < 30) {
                bmiCategory.textContent = langData.overweight.split(':')[0];
                bmiCategory.style.color = 'var(--warning)';
            } else {
                bmiCategory.textContent = langData.obesity.split(':')[0];
                bmiCategory.style.color = 'var(--danger)';
            }
        }

        // -Percentage Calculator
        const baseValueInput = document.getElementById('base-value');
        const percentageInput = document.getElementById('percentage');
        const percentageResult = document.getElementById('percentage-result');
        
        // Add event listeners to percentage inputs
        baseValueInput.addEventListener('input', calculatePercentage);
        percentageInput.addEventListener('input', calculatePercentage);
        
        function calculatePercentage() {
            const baseValue = parseFloat(baseValueInput.value) || 0;
            const percentage = parseFloat(percentageInput.value) || 0;
            
            const result = (baseValue * percentage) / 100;
            // Remove .00 if the number is whole
            percentageResult.textContent = result % 1 === 0 ? Math.round(result) : result.toFixed(2);
            
            updatePercentageChart();
        }
        
        function updatePercentageChart() {
            const baseValue = parseFloat(baseValueInput.value) || 0;
            const percentageVal = parseFloat(percentageInput.value) || 0; // The percentage itself (e.g., 10 for 10%)
            const result = (baseValue * percentageVal) / 100; // The calculated percentage of the base value
            
            const ctx = document.getElementById('percentage-chart').getContext('2d');
            const langData = languages[currentLang];
            
            if (percentageChart) {
                percentageChart.destroy();
            }
            
            percentageChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [langData.baseValue, `${percentageVal}% of Base`], // More descriptive labels
                    datasets: [{
                        label: langData.percentResultLabel, // This label is for the dataset, might not be ideal for individual bars
                        data: [baseValue, result],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)', // Color for Base Value bar
                            'rgba(75, 192, 192, 0.7)'  // Color for Result bar
                        ],
                        borderColor: [
                            'rgba(54, 162, 235, 1)',
                            'rgba(75, 192, 192, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: darkMode ? 'var(--dark)' : 'var(--text-color)'
                            },
                            grid: {
                                color: darkMode ? 'var(--light-gray)' : 'var(--border-color)'
                            }
                        },
                        x: {
                             ticks: {
                                color: darkMode ? 'var(--dark)' : 'var(--text-color)'
                            },
                            grid: {
                                display: false // Usually cleaner for bar charts
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // Dataset label already covers it
                        },
                        title: {
                            display: true,
                            text: langData.graphBtn, // "Show Graph" or similar
                            color: darkMode ? 'var(--dark)' : 'var(--text-color)',
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        // Show "Base Value: value" or "Result: value"
                                        label = `${context.label}: ${context.parsed.y}`;
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function updateChartTheme() {
            if (percentageChart) {
                const newTickColor = darkMode ? 'var(--dark)' : 'var(--text-color)';
                const newGridColor = darkMode ? 'var(--light-gray)' : 'var(--border-color)';
                
                percentageChart.options.plugins.title.color = newTickColor;
                percentageChart.options.scales.y.ticks.color = newTickColor;
                percentageChart.options.scales.x.ticks.color = newTickColor;
                percentageChart.options.scales.y.grid.color = newGridColor;
                percentageChart.update();
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Set today's date as default for date calculator
            const today = new Date().toISOString().split('T')[0];
            if(date1Input) date1Input.value = today;
            if(date2Input) date2Input.value = today;
            
            // Calculate initial values
            if(date1Input && date2Input) calculateDateDifference();
            calculateArea();
            calculateBMI();
            calculatePercentage(); // This calls updatePercentageChart
            
            // Set initial language
            const savedLang = localStorage.getItem('selectedLang');
            if (savedLang && languages[savedLang]) {
                currentLang = savedLang;
            }
            updateLanguage(currentLang); // This will also update chart and BMI category text
            
            // Set initial dark mode if preferred by system, or from localStorage if implemented
            // For now, it defaults to light mode (darkMode = false)
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches && !localStorage.getItem('themeSwitchedByUser')) {
                // If user prefers dark and hasn't manually toggled
                // darkMode = true; // Uncomment to enable system preference detection
                // document.body.classList.add('dark-mode');
                // updateChartTheme();
            }
             // Ensure the toggle reflects the initial darkMode state
            if (darkMode) { // If darkMode was set true by system preference or localStorage
                document.body.classList.add('dark-mode');
                // Potentially update the toggle button's visual state if it doesn't rely purely on .dark-mode body class
            }
        });
    </script>
</body>
</html>